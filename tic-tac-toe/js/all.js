function getTemplate(e,n,t){var l=new XMLHttpRequest;l.open("GET",e,!1),l.status,l.onload=function(){200==l.status?t(l.status,n,l.response):t(l.status)},l.send(null)}function game_setup(){var e=document.getElementById("panel"),n={nplayers:0,side:null,pturn:0,score:{rebel:0,empire:0}};getTemplate("views/player_num_selection.html",e,printTemplate),player_selection(e,n,document.getElementsByClassName("player"))}function player_selection(e,n,t){for(var l=0;l<t.length;l++)t[l].addEventListener("click",function(t){t.preventDefault(),"player1"==this.id?n.nplayers=1:n.nplayers=2,getTemplate("views/side.html",e,printTemplate),side_selection_flow(e,n)})}function side_selection_flow(e,n){var t=document.getElementById("back"),l=(document.getElementById("empire-selection"),document.getElementById("rebel-selection"),document.getElementsByClassName("side")),r="";t.addEventListener("click",function(e){game_setup()});for(var i=0;i<l.length;i++)l[i].addEventListener("click",function(t){t.preventDefault(),getTemplate("views/game.html",e,printTemplate),r="empire-selection"==this.id?"empire":"rebels",n.side=r,game_grid_controller(e,n,r)})}function game_grid_controller(e,n,t){var l=document.getElementById("btn-reset"),r=document.getElementById("btn-home"),i=document.getElementsByClassName("cell"),s=document.getElementsByClassName("player-turn"),a=document.getElementsByClassName("player-score"),o=[null,null,null,null,null,null,null,null,null],u="",c="";l.addEventListener("click",function(e){e.preventDefault(),o=[null,null,null,null,null,null,null,null,null];for(var n=0;n<i.length;n++)i[n].innerHTML="x"}),r.addEventListener("click",function(e){e.preventDefault(),game_setup()}),"rebels"==t?(u="&#64;",c="rebels",n.pturn="rebels"):(u="&#42;",c="empire",n.pturn="empire"),1==n.nplayers&&(s[1].innerHTML="COM",a[1].innerHTML="COM: <span>0</span>");for(var m=0;m<i.length;m++)i[m].addEventListener("click",function(){cell_is_null(o,this.id)&&(this.innerHTML="<span class='selected' id='"+c+"'> "+u+"</span>","empire"==n.pturn?(o=game_array(o,this.id,n.pturn),u="&#64;",c="rebels",rules(o,n.pturn),n.pturn="rebels"):(u="&#42;",c="empire",o=game_array(o,this.id,n.pturn),n.pturn="empire"))})}function cell_is_null(e,n){return null===e[game_grid_location(n)]}function game_grid_location(e){switch(e){case"top-left":return 0;case"top":return 1;case"top-right":return 2;case"middle-left":return 3;case"middle":return 4;case"middle-right":return 5;case"bottom-left":return 6;case"bottom":return 7;case"bottom-right":return 8;default:console.log("Something was wrong")}}function game_array(e,n,t){var l;return l=game_grid_location(n),e[l]=t,e}function printTemplate(e,n,t){200==e?n.innerHTML=t:console.log("Error:"+e)}function rules(e,n){var t=[],l=[[1,1,1,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1],[1,0,0,1,0,0,1,0,0],[0,1,0,0,1,0,0,1,0],[0,0,1,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1],[0,0,1,0,1,0,1,0,0]];t=array_converter(t,e,n);for(var r=0;r<l.length;r++)if(3==t.intersection(l[r]).length)return console.log("Winner"),!0;return!1}function array_converter(e,n,t){for(var l=0;l<=8;l++)n[l]==t?e.push(1):e.push(0);return console.log(e),e}window.addEventListener("load",function(e){game_setup()}),console.log("Prototype added"),Array.prototype.intersection=function(e){var n=[];return this.forEach(function(t,l){t===e[l]&&n.push(t)}),n.filter(function(e){return 0!==e})};